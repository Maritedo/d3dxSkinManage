# batch_processing_tools
批量处理工具插件

## 功能简介

该插件可以辅助你进行批量操作<br>
目前包含批量删除、批量导出、批量导入、批量删除 mod 缓存、批量重新导入 mod 缓存、批量修复黄色倒影、批量修复角色黄边、预设以及卸载全部已加载 mods 等功能<br>

_<weaken>其他功能正在开发中，请稍作等待……</weaken>_

## 快速下载

:::info v0.10.2
更新日期:  2024-05-18<br/>
下载链接: [gitee](https://gitee.com/ticca/d3dx-skin-manage/releases/download/plugins/batch_processing_tools_v0.10.2.zip) <br/>
:::

## 使用教程

### 加载插件
首先，也是最基础的一步——**加载插件**，请参考 [插件使用教程](/help/tutorial-plugins)

### 打开批量处理工具
在管理器的 **工具** 页面下点击 **批量处理工具** 按钮或者直接点击管理器右下角的 **[批量处理]** 按钮即可打开批量处理工具界面。

![](/static/image/a12636d0.png)

打开工具界面后，点击你想要进行的操作的按钮即可开始对应的操作啦！

![](/static/image/f71fc581.png)

### 通用操作指引
- #### 选中功能
    除预设功能外，其他操作都可以对同一作用对象下的 mod 进行多选，你可以通过点击 **选中状态** 列下的对应位置快速选中或者取消选中某个分类或某个作用对象下的 mods，或某个 mod；也可以通过点击左下角的 **全选** 按钮快速选中所有的 mods；也可以通过点击左下角的 **取消全选** 按钮取消所有选中的 mods。

    ![](/static/image/2112fd33.png)

- #### 默认配置
    部分操作存在 **默认配置选择槽**，你可以修改该选择槽中的各个参数，更改参数后再被选中的 mod 将按照你修改后的参数进入选中状态。

    ![](/static/image/14b9dbe1.png)

- #### 选中配置
    存在默认配置的操作也会存在对应的选中配置，当你点击任意选中栏中的 mod 时，**选中配置选择槽** 中将显示该被点击的 mod 的当前配置。此时，你可以在 **选中配置选择槽** 中对该被点击的 mod 的配置进行修改。

    ![](/static/image/124a018b.png)

- #### 筛选功能
    在筛选栏中输入想要搜索的 **SHA**、**分类**、**作用对象**、**模组名称**、**年龄分级**、**模组作者**、**类型标签** 关键词即可进行筛选，多个值之间使用 `空格` 分割进行关联筛选。此外，可以使用 `!` (英文字符) 符号开头拒绝对应关键词。

    ![](/static/image/05870db6.png)

- #### 执行操作
    在确认选中的要执行操作的 mod 无误后，点击右下角的 **下一步** 按钮后即可执行对应的操作。部分操作可能耗时较久，你需精心等待片刻！

    :::warning 警告
    大部分操作界面下的 **下一步** 按钮没有二级确认功能，所以在执行对应操作前请确保选择无误！！！
    :::

### 批量删除
批量删除操作可以辅助你快速删除不再想要使用的 mod，执行操作后会让它不再在管理器中显示并清理你所选中配置的相应文件。

通用操作请参考 [通用操作指引](#通用操作指引)，下面是该操作中的配置参数说明：<br/>
**完全移除** 参数的执行效果与删除单个 mod 操作中的 **销毁** 操作效果一致，即删除模组文件及删除模组信息。<br/>
**删除** 参数的执行效果与删除单个 mod 操作中的 **移除** 操作效果一致，即删除模组文件但不删除模组信息。

### 批量重新导入 mod 缓存
批量重新导入 mod 缓存操作可以将 mod 缓存文件按指定的方式重新导入到管理器中。如果你自行修改了大量的 mod 缓存文件，想要将这些修改的内容保存至源文件中存储，即可使用此操作来辅助你完成。此外，若你想将通过修复插件修复后的 mod 缓存文件内容保存至源文件中存储，也可以使用此操作。

通用操作请参考 [通用操作指引](#通用操作指引)，下面是该操作中的配置参数说明：<br/>
**压缩包格式** 参数就是压缩包的保存格式，目前只支持 zip 及 7z 两种格式。<br/>
**是否删除原 mod** 参数为`是`时会对所选中的 mod 进行 **完全移除** 操作（即删除模组文件及删除模组信息），这样该选中的 mod 不会再在管理器中显示。若为`否`，则该选中的 mod 的相应模组信息依旧存在于管理器中。无论选择哪个选项，重新导入的 mod 缓存文件会以生成新的模组信息的方式存在于管理器中。<br/>
**导出预览图至压缩包** 参数为`是`时，会将所选的 mod 在管理器中存储的预览图一起以程序能自动获取的方式存储至导出的压缩包中。选择该参数重新导入的 mod，在被加载后，会被程序自动识别到预览图并存储至管理器中保存，这样你就不需要再次为这个 mod 重新添加预览图了。

### 批量删除 mod 缓存
批量删除 mod 缓存操作可以辅助你快速的删除不再经常使用的 mod 缓存文件，释放你的存储空间。该操作除通用操作外无特殊配置参数，通用操作请参考 [通用操作指引](#通用操作指引)。

### 批量修复黄色倒影
批量修复黄色倒影操作用于修复原神角色 mod 出现黄色倒影的情况。通用操作请参考 [通用操作指引](#通用操作指引)，相关配置参数请查阅该操作界面的说明部分。

### 批量修复角色黄边
批量修复角色黄边操作用于修复角色 mod 出现黄边的情况。通用操作请参考 [通用操作指引](#通用操作指引)，相关配置参数请查阅该操作界面的说明部分。

### 批量导出
批量导出操作会将你所选的 mod 导出至指定的文件夹中以压缩包的形式存储，用于进行管理器迁移或与它人分享 mod。比如你在一开始使用时用了多个 d3dx 管理器分别存储不同用户环境的 mod，现在想要合并，就可以通过这个操作进行导出后，在另外的 d3dx 管理器中使用该插件的批量导入操作进行导入；又比如你想分享你整理的 mod 给别人，也可以通过这个功能导出后，让别人通过该插件的导入操作导入进他的管理器中。

通用操作请参考 [通用操作指引](#通用操作指引)，下面是该操作中的配置参数说明：

- #### 导出设置参数
    **保存路径** 是指导出 mod 要存放的路径，且该路径需要为`空文件夹`，否则会报错！ <br/>
    **导出索引文件** 选择`是`时会导出对应的索引文件。导出索引文件后可以在导入时保留当前用户环境下 mod 的配置信息，如 mod 的 模组名称、年龄分级、模组作者、类型标签等信息，这样在新的管理器中就不需要重新配置了！ <br/>
    **导出预览图** 选择`是`时会导出对应的预览图。导出预览图后，在导入时，则可以在导入窗口预览有预览图的 mod，且在导入时可以快速的将预览图导入到管理器中。该选项会方便在导入时选择自己所需要的 mod 进行导入!

- #### 默认配置参数
    **导出方式** 是指导出 mod 的方式，是要导出`原始文件`还是`缓存文件`。如果经常修改 mod 的缓存文件，建议选择`导出缓存文件`，这样你修改的配置才会被保留下来。这里说明一下，选择`导出缓存文件`时，若 mod 没有缓存文件，则会默认修改为`导出原始文件`。

    **导出预览图至压缩包** 是指将对应的 mod 在管理器中存储的预览图一起存储至导出的压缩包中，对应的 mod 在重新导入程序时并加载后，在触发程序自动识别预览图机制后存储至管理器中保存。选择`导出预览图至压缩包`的好处是可以方便分享，让别人可以快速知道这个 mod 的样子。

:::info 导出设置中 **导出预览图** 与 默认配置中 **导出预览图至压缩包** 的区别
**导出预览图** 选项不会将预览图压缩至 mod 压缩包中，而是都存储在 **保存路径** 下的 `preview` 和 `preview_screen` 文件夹下，在进行 **批量导入** 操作时需要 **导入预览图** 选择`是`时才会更新至管理器中，且无需加载 mod 即可正常显示预览图，而 **导出预览图至压缩包** 选项会将预览图压缩至 mod 压缩包中，在导入管理器后，需要被加载触发程序自动识别预览图机制后才会存储至管理器中保存。
:::

### 批量导入
批量导入操作用于将通过批量导出操作导出的 mod 重新导入到管理器中。

通用操作请参考 [通用操作指引](#通用操作指引)，下面是该操作中的配置参数说明：
**导入路径** 通过说明卡槽中的输入框进行输入，或者通过点击右侧的 **路径选择** 按钮输入。要选择的路径是在 **批量导出** 操作中s所选择的`保存路径`，如果要导入的是别人分享给你的压缩包，请先将此压缩包解压至一个空文件夹后，选择 `Mods 文件夹`的上一级文件夹。

![](/static/image/503b5ed0.png)

**导入索引文件** 及 **导入预览图** 对应 **批量导出** 操作的导出设置中 **导出索引文件** 及 **导出预览图** 选项。若进行 **批量导出** 操作时，这两个对应的导出选项选择了`是`，则此时对应的导入选项可以选择`是`，从而将索引文件或预览图导入到管理器中。

### 预设
预设操作可以给不同的作用对象指定其使用的 mod 并记录下来，然后在启用预设时快速的将指定的作用对象切换至指定的 mod。

- #### 工具界面设置预设
    首先，输入你要配置的预设的 **预设名称**。然后通过点击 **选中状态** 列下的对应位置选中或者取消选中某个 mod <Badge type="warning" text="(一个作用对象只能选择一个 mod )" />；或者通过点击左下角的 **全不选** 按钮取消所有选中的 mods。选择完成后，点击 **保存预设** 按钮进行保存。

    ![](/static/image/d467b2f4.png)

    你可以通过点击 **启用预设** 按钮来启用当前选中的预设。

    你可以通过点击 **删除预设** 按钮来删除当前选中的预设。

    你可以在筛选栏中输入想要搜索的 **SHA**、**分类**、**作用对象**、**模组名称**、**年龄分级**、**模组作者**、**类型标签** 关键词即可进行筛选，多个值之间使用 `空格` 分割进行关联筛选。此外，可以使用 `!` (英文字符) 符号开头拒绝对应关键词。

- #### 快捷设置预设
    除了上述在工具界面进行预设的相关操作外，你也可以直接点击管理器右下角的 **[预设]** 按钮来进行预设操作。

    点击 **[预设]** 按钮后，会弹出一个菜单。将鼠标移动至菜单中的 **更新已加载 mods 至预设** 选项上，会再显示出一个子菜单。点击子菜单上的 **-新的预设-** 后会弹出一个窗口，需要你填写预设名称，完成填写后点击 **保存** 按钮即可将当前已加载的 mods 更新至新的预设中。

    ![](/static/image/d6be0462.png)

    或者，你也可以点击子菜单上其他已存在的预设名称，这样会将当前已加载的 mods 覆盖至对应的预设中。

    在点击 **[预设]** 按钮后弹出的菜单中，鼠标移动至 **启用预设** 或 **删除预设** 选项上，会显示出对应的子菜单。点击子菜单上的预设名称即可 `启用` 或 `删除` 对应的预设。

    你也可以再 **[预设]** 按钮后弹出的菜单中点击 **卸载全部 Mods** 选进行卸载全部已加载的 Mods。

- #### 启用预设卸载已加载 mod 设置
    在管理器的 **环境设置** 页面下 **全局设置** 中，你可以配置 **启用预设卸载已加载 mod** 选项。该选项默认为 `开启` 状态，此时启用任意一个预设时，都会先进行 **卸载全部 Mods** 操作，再加载预设的内容，也就是说启用预设时只会加载预设中所设置的 mod，无法实现多个预设联合搭配的效果。当其 `关闭` 时则不会卸载已加载的 mods，在这种情况下你可以对预设进行分类，实现多个预设搭配启用的效果。

### 卸载全部已加载 mods
在选择栏右键呼出菜单，并选择 **卸载全部 Mods** 选项，即可卸载全部已加载的 Mods。

![](/static/image/3d75bfdb.png)

### 卡顿情况说明
在部分情况下（如刚启动管理器、刚修改头像名称匹配算法等情况），会因为缩略图未被加载至缩略图缓存的原因，导致在使用批量处理工具的任何一个具体功能时，需要先进行加载大量的缩略图，这会使得对应的功能窗口打开时间增长，发生明显的卡顿现象,若遇到此情况，请耐心等待加载完成后再进行对应操作。

## 视频教程链接

[批量删除 mod 教程](https://www.bilibili.com/video/BV1gf421m7Xz/) | [批量导出 mod 教程](https://www.bilibili.com/video/BV1Nx4y1W7dW/) | [批量导入 mod 教程](https://www.bilibili.com/video/BV1Bi421D7t8/) 

视频教程由 [@黎愔](/contribution) 录制和提供。

## 更新日志

### v0.10.2
#### 修复
- 修复主程序 1.5.38 更新后由于工具界面逻辑更替导致该插件无法使用的问题

#### 删除
- 删除批量编辑 mod 信息按钮的占位，该功能已于主程序 1.5.36 更新后实现，该插件不会再去实现相关功能

### v0.10.1
#### 新增
- 预设功能的启用预设功能支持在启用时可不卸载已启用的 Mods

#### 优化
- 优化各选择列表的全不选逻辑的性能问题

### v0.10.0
#### 新增
- 新增批量修复黄色倒影功能
- 新增批量修复角色黄边功能

#### 修复
- 修复特殊情况下（如模组名称相同时）批量导出工具在进行导出时可能产生的问题

#### 优化
- 优化批量删除、批量导出、批量删除 mod 缓存、批量重新导入 mod 缓存功能中，因权限异常导致无法正常删除时的可操作功能，添加打开文件夹所在位置按钮，方便进行快速手动删除

#### 重构
- 对大部分的批量处理功能的底层逻辑进行重构

### v0.9.1
#### 新增
- 预设快捷按钮中添加卸载全部 mods 选项

#### 修复
- 修复批量导出功能中对象名为非法文件字符时导出异常问题

### v0.9.0
#### 新增
- 新增预设功能
- 主界面右下角新增 [批量处理] [预设] 两个按钮用于快捷地打开批量处理工具窗口和进行预设操作
- 对象栏右键菜单栏新增 卸载全部 mods 选项

### v0.8.0
#### 新增
- 新增批量删除 mod 缓存功能
- 新增批量重新导入 mod 缓存功能

#### 修复
- 修复批量导出功能中模组名称存在非法文件字符时的导出异常问题

### v0.7.0
#### 新增
- 新增批量导入功能

#### 修改
- 修改部分布局调整


### v0.6.5
#### 新增
- 新增预览图预览功能
- 批量删除功能及批量导出功能新增全选及取消全选按钮

#### 优化
- 优化部分性能问题

### v0.6.0
#### 新增
- 新增批量导出功能

### v0.5.0
#### 新增
- 新增批量删除功能